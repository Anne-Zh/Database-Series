# 组合使用数据存储技术

数据库中内置的功能与人们用批处理和流处理器构建的衍生数据系统似乎有相似之处。

## 创建索引

想想当你运行 CREATE INDEX 在关系数据库中创建一个新的索引时会发生什么。数据库必须扫描表的一致性快照，挑选出所有被索引的字段值，对它们进行排序，然后写出索引。然后它必须处理自一致快照以来所做的写入操作（假设表在创建索引时未被锁定，所以写操作可能会继续）。一旦完成，只要事务写入表中，数据库就必须继续保持索引最新。

此过程非常类似于设置新的从库副本，也非常类似于流处理系统中的引导（bootstrap） 变更数据捕获。无论何时运行 CREATE INDEX，数据库都会重新处理现有数据集，并将该索引作为新视图导出到现有数据上。现有数据可能是状态的快照，而不是所有发生变化的日志，但两者密切相关。

## 一切的元数据库

有鉴于此，我认为整个组织的数据流开始像一个巨大的数据库，每当批处理，流或 ETL 过程将数据从一个地方传输到另一个地方并组装时，它表现地就像数据库子系统一样，使索引或物化视图保持最新。
